# Mock API Server Configuration
# Define your API endpoints using list format with pattern matching

endpoints:
  # Simple exact match example
  - name: "Get devices"
    path_pattern: "/api/devices"
    match_type: "exact"
    status_code: 200
    response_data:
      devices:
        - id: 1
          name: Router1
          status: active
          ip: 192.168.1.1
        - id: 2
          name: Switch1
          status: active
          ip: 192.168.1.2

  # Simple exact match with config
  - name: "Get config"
    path_pattern: "/api/config"
    match_type: "exact"
    status_code: 200
    response_data:
      config:
        timeout: 30
        retry: 3
        enable_logging: true

  # APIC login
  - name: "ACI APIC Login"
    path_pattern: "/api/aaaLogin.json"
    match_type: "exact"
    method: "POST"
    status_code: 200
    response_data:
      totalCount: "1"
      imdata:
        - aaaLogin:
            attributes:
              token: "eyJhbGciOiJSUzI1NiIsImtpZCI6InFidm5sdjBkZXJjcXlxODNoaHBhbHlqbGkzejlyaWZqIiwidHlwIjoiand0In0.eyJyYmFjIjpbeyJkb21haW4iOiJjb21tb24iLCJyb2xlc1IiOjE4MzUwMDQsInJvbGVzVyI6MH0seyJkb21haW4iOiJhbGwiLCJyb2xlc1IiOjAsInJvbGVzVyI6MX1dLCJpc3MiOiJBQ0kgQVBJQyIsInVzZXJuYW1lIjoianVjaG93YW4tb3NwMTYiLCJ1c2VyaWQiOjEyNzQxLCJ1c2VyZmxhZ3MiOjAsImF1dGhfdGltZSI6MTc2NTgwMzEyMywiaWF0IjoxNzY1ODAzMTIzLCJleHAiOjE3NjU4MTI3MjMsInNlc3Npb25pZCI6IkhkK2tKK2tVVGs2WmFSczRQdzdyRHc9PSJ9.fuRoo1oQyE6uGJTWKNESRvMjjvbkn4RVXzkzM76eLrcEN4ZCIq1tK7QhA2PpCNbYZGvIKfODtQnkVvValUkOy8DzcZ-u9yv7o2xllWntsu8EPbnQWY7YCBfqDPALxiXTaGHB3ot4AgnU8T9cWLM2ffWHVGnpGetKxmWU9o1eCrQKvvvMB_YX2-UyVQXTXUomjuZrR0rv9UME_spfhj7WmcwxWjhTVtgBvARa6-WMPJCeKbiHuO4x1jTR3-kxq5D5oD3g9VcdoFTWV1i4GaLxByh4vzDo8tLVJXpWOzdLXXl-TcSh054EGCbm0dRik6miXAkdicCi5u5lBGfrIQ-Upw"
              siteFingerprint: "qbvnlv0dercqyq83hhpalyjli3z9rifj"
              refreshTimeoutSeconds: "9600"
              maximumLifetimeSeconds: "86400"
              guiIdleTimeoutSeconds: "65525"
              restTimeoutSeconds: "90"
              creationTime: "1765803123"
              firstLoginTime: "1765803123"
              userName: "juchowan-osp16"
              remoteUser: "false"
              unixUserId: "12741"
              sessionId: "Hd+kJ+kUTk6ZaRs4Pw7rDw=="
              lastName: ""
              firstName: ""
              changePassword: "no"
              version: "6.1(4h)"
              buildTime: "Fri Aug 08 21:57:42 PDT 2025"
              node: "topology/pod-1/node-1"
            children:
              - aaaUserDomain:
                  attributes:
                    name: "common"
                    rolesR: "tenant-connectivity,tenant-protocol,vmm-policy,tenant-ext-connectivity,tenant-ext-protocol,tenant-qos,tenant-security,tenant-network-profile,tenant-epg,fabric-connectivity,fabric-protocol,fabric-equipment,access-connectivity,access-protocol,access-equipment,access-qos,ops,nw-svc-policy"
                    rolesW: ""
                  children:
                    - aaaReadRoles:
                        attributes: {}
                        children:
                          - role:
                              attributes:
                                name: "read-all"
                    - aaaWriteRoles:
                        attributes: {}
              - aaaUserDomain:
                  attributes:
                    name: "all"
                    rolesR: "admin"
                    rolesW: "admin"
                  children:
                    - aaaReadRoles:
                        attributes: {}
                    - aaaWriteRoles:
                        attributes: {}
                        children:
                          - role:
                              attributes:
                                name: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/tn-infra"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/l3dom-arsarkar_ABB_FW_L3DOM"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/vmmp-Nutanix/dom-test"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/tn-common"
                    readPrivileges: "admin,tenant-connectivity,tenant-protocol,vmm-policy,tenant-ext-connectivity,tenant-ext-protocol,tenant-qos,tenant-security,tenant-network-profile,tenant-epg,fabric-connectivity,fabric-protocol,fabric-equipment,access-connectivity,access-protocol,access-equipment,access-qos,ops,nw-svc-policy"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/tn-test-tenant"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/tn-ABC"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/tn-adstachu-s2t1"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "comp/prov-Nutanix/dom-test"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "uni/tn-mgmt"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - DnDomainMapEntry:
                  attributes:
                    dn: "comp/prov-Nutanix/ctrlr-[test]-test"
                    readPrivileges: "admin"
                    writePrivileges: "admin"
              - ReadOnlySubtrees:
                  attributes:
                    count: "1"
                    description: "List of subtree DNs derived from RBAC domains assigned to this user (domain 'all' privileges do not require RBAC rules to grant access and are not shown below)"
                  children:
                    - RbacRule:
                        attributes:
                          subtreeDn: "uni/tn-common"
                          domain: "common"

  # Complex URL with query parameters using 'contains' match
  - name: "ACI infraWiNode query pod-1 node-1"
    path_pattern: 'node/class/infraWiNode.json?query-target-filter=wcard(infraWiNode.dn,"topology/pod-1/node-1/")'
    match_type: "contains"
    method: "GET"
    status_code: 200
    response_data:
      totalCount: "3"
      imdata:
        - infraWiNode:
            attributes:
              addr: "10.121.0.1"
              adminSt: "in-service"
              annotation: ""
              apicMode: "active"
              chassis: "e703fe86-60ca-11ef-a6f8-29739de72532"
              childAction: ""
              cntrlSbstState: "approved"
              dn: "topology/pod-1/node-1/av/node-1"
              extMngdBy: ""
              failoverStatus: "idle"
              force: "no"
              health: "fully-fit"
              id: "1"
              lcOwn: "local"
              mbSn: "WMP26180019"
              modTs: "2025-06-29T14:39:40.778-05:00"
              monPolDn: "uni/fabric/monfab-default"
              mutnTs: "2025-06-29T13:28:58.022-05:00"
              name: ""
              nameAlias: ""
              nodeName: "NET-FABRIC-1-M1-APIC-1"
              operSt: "available"
              podId: "1"
              routableIpAddr: "0.0.0.0"
              status: ""
              targetMbSn: ""
              uid: "0"
              userdom: "all"
        - infraWiNode:
            attributes:
              addr: "10.121.0.3"
              adminSt: "in-service"
              annotation: ""
              apicMode: "active"
              chassis: "855f1238-751f-11ef-989c-df29068b6309"
              childAction: ""
              cntrlSbstState: "approved"
              dn: "topology/pod-1/node-1/av/node-3"
              extMngdBy: ""
              failoverStatus: "idle"
              force: "no"
              health: "fully-fit"
              id: "3"
              lcOwn: "local"
              mbSn: "WMP2618001E"
              modTs: "2025-06-29T14:39:40.598-05:00"
              monPolDn: "uni/fabric/monfab-default"
              mutnTs: "2024-09-17T13:29:21.709-05:00"
              name: ""
              nameAlias: ""
              nodeName: "NET-FABRIC-1-M2-APIC3"
              operSt: "available"
              podId: "2"
              routableIpAddr: "0.0.0.0"
              status: ""
              targetMbSn: ""
              uid: "0"
              userdom: "all"
        - infraWiNode:
            attributes:
              addr: "10.121.0.2"
              adminSt: "in-service"
              annotation: ""
              apicMode: "active"
              chassis: "d92085fc-745f-11ef-bcdf-07caeb603b73"
              childAction: ""
              cntrlSbstState: "approved"
              dn: "topology/pod-1/node-1/av/node-2"
              extMngdBy: ""
              failoverStatus: "idle"
              force: "no"
              health: "fully-fit"
              id: "2"
              lcOwn: "local"
              mbSn: "WMP261800B0"
              modTs: "2025-06-29T14:39:40.797-05:00"
              monPolDn: "uni/fabric/monfab-default"
              mutnTs: "2024-09-17T13:11:42.061-05:00"
              name: ""
              nameAlias: ""
              nodeName: "NET-FABRIC-1-M1-APIC2"
              operSt: "available"
              podId: "1"
              routableIpAddr: "0.0.0.0"
              status: ""
              targetMbSn: ""
              uid: "0"
              userdom: "all"

  # Match any infraWiNode query using 'contains'
  - name: "ACI infraWiNode query (generic)"
    path_pattern: "node/class/infraWiNode.json"
    match_type: "contains"
    method: "GET"
    status_code: 200
    response_data:
      totalCount: "3"
      imdata:
        - infraWiNode:
            attributes:
              addr: "10.121.0.1"
              adminSt: "in-service"
              dn: "topology/pod-1/node-1/av/node-1"
              health: "fully-fit"
              id: "1"
              nodeName: "NET-FABRIC-1-M1-APIC-1"
              operSt: "available"
              podId: "1"
        - infraWiNode:
            attributes:
              addr: "10.121.0.3"
              adminSt: "in-service"
              dn: "topology/pod-1/node-1/av/node-3"
              health: "fully-fit"
              id: "3"
              nodeName: "NET-FABRIC-1-M2-APIC3"
              operSt: "available"
              podId: "2"
        - infraWiNode:
            attributes:
              addr: "10.121.0.2"
              adminSt: "in-service"
              dn: "topology/pod-1/node-1/av/node-2"
              health: "fully-fit"
              id: "2"
              nodeName: "NET-FABRIC-1-M1-APIC2"
              operSt: "available"
              podId: "1"

  # Using regex for pattern matching
  - name: "API versioned endpoints"
    path_pattern: "^/api/v[0-9]+/.*"
    match_type: "regex"
    status_code: 200
    response_data:
      version: "1.0"
      data: {}

  # Using starts_with for path prefix matching
  - name: "Admin endpoints"
    path_pattern: "/admin/"
    match_type: "starts_with"
    status_code: 403
    response_data:
      error: "Forbidden"
      message: "Access denied"

  # Error endpoint
  - name: "Error endpoint"
    path_pattern: "/api/error"
    match_type: "exact"
    status_code: 500
    response_data:
      error: "Internal server error"
      message: "Something went wrong"

  # Not found endpoint
  - name: "Missing resource"
    path_pattern: "/api/missing"
    match_type: "exact"
    status_code: 404
    response_data:
      error: "Resource not found"

  # Unauthorized endpoint
  - name: "Protected resource"
    path_pattern: "/api/protected"
    match_type: "exact"
    status_code: 401
    response_data:
      error: "Unauthorized"
      message: "Authentication required"
